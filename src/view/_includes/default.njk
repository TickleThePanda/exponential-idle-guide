<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    {% if description %}<meta name="description" content="{{ description }}">{% endif %}
    <link href="/style/main.css" rel="stylesheet">
    <script async defer
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML">
    </script>
    <script type="module" async defer src="/scripts/color-scheme.js"></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        showMathMenu: false,
        CommonHTML: { linebreaks: { automatic: true } },
        "HTML-CSS": { linebreaks: { automatic: true } },
        SVG: { linebreaks: { automatic: true } }
      });
    </script>
    <script async defer src="https://www.googletagmanager.com/gtag/js?id=G-CQWRWZCSZW"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-CQWRWZCSZW');
    </script>
    <title>{{title}} - Exponential Idle Guides</title>
    <script>
      const root = document.documentElement;
      const isMobile = navigator.userAgentData.mobile;
      const query_root  =  document.querySelector(':root');
      window.alert("Is Mobile? " + isMobile + "\nroot classes: " + root.classList);

      if (isMobile) {
        root.classList.add("mobile");
        try{root.classList.remove("desktop");}catch(error){}
        window.alert("Mobile class set");
      } else {
        root.classList.add("desktop");
        try{root.classList.remove("mobile");}catch(error){}
        window.alert("desktop class set");
      }

      function openSidebar(sidebars,sidebarheaders) {
        for (const sidebar of sidebars) {
          document.getElementById(sidebar).style.zIndex = "0";
        }
        document.getElementById(sidebars[0]).style.zIndex = "10";
        
        if (!isMobile) {
          window.alert("desktop");
          if (getComputedStyle(query_root).getPropertyValue('--btn-marginLeft') == "0%" 
              && getComputedStyle(query_root).getPropertyValue('--sidebar-width') == "0%") {
            window.alert("inside if");
            maxwidth = 0;
            maxheaderwidth = 0;
            mainwidth = document.getElementById("sidebarmain").offsetWidth;

            for (const sidebar of sidebars) {
              document.getElementById(sidebar + "invis").style.width = "auto";
              if(document.getElementById(sidebar + "invis").offsetWidth > maxwidth){
                maxwidth = document.getElementById(sidebar + "invis").offsetWidth;
              }
              document.getElementById(sidebar + "invis").style.width = 0;
            }

            document.getElementById(sidebarheaders).style.width = "auto";
            maxheaderwidth = document.getElementById(sidebarheaders).offsetWidth;
            document.getElementById(sidebarheaders).style.width = "0%";

            if (maxwidth <= 0 && maxheaderwidth <= 0) {
              query_root.style.setProperty('--sidebar-width', 'auto');
              query_root.style.setProperty('--btn-marginLeft', 'auto');
            } else {
              if(maxheaderwidth >= window.visualViewport.width * 0.26){
                output = maxheaderwidth + window.visualViewport.width * 0.02;
              } else if (maxwidth >= window.visualViewport.width * 0.26) {
                output = window.visualViewport.width * 0.26;
              } else {
                output = maxwidth;
              }

              if((output + mainwidth) >= window.visualViewport.width){
                output = window.visualViewport.width * 0.96 - mainwidth;
              
              }
              query_root.style.setProperty('--sidebar-width', output + "px");
              query_root.style.setProperty('--btn-marginLeft', (output + window.visualViewport.width * 0.04) + "px");
              query_root.style.setProperty('--sidebar-padding', window.visualViewport.width * 0.02 + "px");
            }
          }
        } else {
          window.alert("mobile");
          if (getComputedStyle(query_root).getPropertyValue('--btn-marginTop') == "0%" 
              && getComputedStyle(query_root).getPropertyValue('--sidebar-height') == "0%") {
            window.alert("inside if");
            max_height = 0;
            max_header_height = 0;
            main_height = document.getElementById("sidebarmain").offsetHeight;

            for (const sidebar of sidebars) {
              document.getElementById(sidebar + "invis").style.height = "auto";
              if(document.getElementById(sidebar + "invis").offsetHeight > max_height){
                max_height = document.getElementById(sidebar + "invis").offsetHeight;
              }
              document.getElementById(sidebar + "invis").style.height = "0%";
            }

            document.getElementById(sidebarheaders).style.height = "auto";
            max_header_height = document.getElementById(sidebarheaders).offsetHeight;
            document.getElementById(sidebarheaders).style.height = "0%";

            if (max_height <= 0 && max_header_height <= 0) {
              query_root.style.setProperty('--sidebar-height', 'auto');
              query_root.style.setProperty('--btn-marginTop', 'auto');
            } else {
              if(max_header_height >= window.visualViewport.height * 0.26){
                output = max_header_height + window.visualViewport.height * 0.02;
              } else if (max_height >= window.visualViewport.height * 0.26) {
                output = window.visualViewport.height * 0.26;
              } else {
                output = maxw_height;
              }

              if((output + main_height) >= window.visualViewport.height){
                output = window.visualViewport.height * 0.96 - main_height;
              
              }
              query_root.style.setProperty('--sidebar-height', output + "px");
              query_root.style.setProperty('--btn-marginTop', (output + window.visualViewport.height * 0.04) + "px");
              query_root.style.setProperty('--sidebar-padding', window.visualViewport.height * 0.02 + "px");
            }
          }
        }
        window.alert(getComputedStyle(query_root).getPropertyValue('--sidebar-column-count'));
        window.alert(getComputedStyle(query_root).getPropertyValue('--sidebar-column-gap'));
      }

      function closeSidebar(input1, input2) {
        query_root.style.setProperty('--sidebar-' + input, "0%");
        query_root.style.setProperty('--btn-margin' + input2, "0%");
        query_root.style.setProperty('--sidebar-padding', "0");
      }

      window.addEventListener('click', function(e){
        if (!mobile) {
          if (Math.round(document.getElementById("HeaderSidebar").offsetWidth - window.visualViewport.width * 0.04) >= Number(window.getComputedStyle(document.body).getPropertyValue('--sidebar-width').match(/\d+/)[0]) 
              && getComputedStyle(query_root).getPropertyValue('--sidebar-width') != "0%") {
            bool = false;
            sidebarlist = ['GuideSidebar','HeaderSidebar','ResourceSidebar','sidebarmain'];
            for(const sidebars of sidebarlist){
              if (document.getElementById(sidebars).contains(e.target)){
                bool = true;
                break;
              }
            }
            if(!bool){
              closeSidebar('width', 'Left');
            }
          }
        } else {
          if (Math.round(document.getElementById("HeaderSidebar").offsetHeight - window.visualViewport.height * 0.04) >= Number(window.getComputedStyle(document.body).getPropertyValue('--sidebar-height').match(/\d+/)[0]) 
              && getComputedStyle(query_root).getPropertyValue('--sidebar-height') != "0%") {
            bool = false;
            sidebarlist = ['GuideSidebar','HeaderSidebar','ResourceSidebar','sidebarmain'];
            for(const sidebars of sidebarlist){
              if (document.getElementById(sidebars).contains(e.target)){
                bool = true;
                break;
              }
            }
            if(!bool){
              closeSidebar('height', 'Top');
            }
          }
        }
      })

      function openpopup(display_id){
        if(document.getElementById(display_id).style.display == "block"){
          document.getElementById(display_id).style.display = "none";
        } else {
          document.getElementById(display_id).style.display = "block";
        }
      }
    </script>
  </head>
  <body>
    {% block sidebar %}{% endblock %}

    <header class="page-section header" id="top">
      <button class="btn-color-scheme-toggle">
        <span class="light"><img alt="Light mode toggle" src="/images/sun.svg"></span>
        <span class="dark"><img alt="Dark mode toggle" src="/images/moon.svg"></span>
      </button>
      <h1><a href="/">Exponential Idle Guides</a></h1>
      {{ nav | safe }}
    </header>

    <main class="page-section content-wrapper">
      {% block title %}
        <h2>{{title}}</h2>
        {% if subtitle %}
          <p class="subtitle">{{ subtitle }}</p>
        {% endif %}
      {% endblock %}

      {% block main %}{% endblock %}

      {% if nav %}
        <div class="post-content-nav">
        </div>
      {% endif %}
    </main>
    
    <footer class="page-section footer">
      <div class="footer__section footer__section--main">
        {{ nav | safe }}
      </div>
      <div class="footer__section">
        <p>Any feedback?   <a href="https://docs.google.com/forms/d/e/1FAIpQLSdje1OWIgI1vqMry6U1E51bxh3VE4tLilTdRyqun1aVmP7pag/viewform">
          Submit it to us.
        </a>
        <p>Want to see the responses? <a href="https://bit.ly/ex-guide-suggestion-responses">
          Take a look.
        </a>
      </div>
      <div class="footer__section">
        <p>Guides copyright <a href="https://github.com/LEBaldy">LEâ˜…Baldy</a> & <a href="https://github.com/Snaeks">Snaeky</a>.
        <p>Website created by <a href="https://ticklethepanda.dev">TickleThePanda</a>.
      </div>
      
      <a href="#top" class="back-to-top-link" aria-label="Scroll to Top">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <polyline points="18 15 12 9 6 15" />
        </svg>
      </a>
    </footer>
  </body>
</html>
