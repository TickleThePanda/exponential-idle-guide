{% extends "default.njk" %}

{% set nav %}
  {% set navlist = [collections.guides, collections.advanced, collections.rankings] %}
  
  <nav class="pagination">
    {% for posts in navlist %}
      {% set previous = posts | getPreviousCollectionItem(page) %}
      {% set next = posts | getNextCollectionItem(page) %}

      {% if previous %}
        <a href="{{previous.url}}">Previous: {{previous.data.title}}</a>
      {% endif %}
      {% if next %}
        <a href="{{next.url}}" class="pagination__next">Next: {{next.data.title}}</a>
      {% endif %}
    {% endfor %}
  </nav>
{% endset %}

{% block main %}

  {% if author or contributors %}
    <p class="byline">
      {% if author %}Guide written by <strong>{{ author }}</strong>.{% endif %}
      {% if contributors %}Contributions from <strong>{{ contributors }}</strong>.{% endif %}
  {% endif %}

  {% if draft %}
    <p class="draft-warning">
      This guide is currently undergoing change.
      Keep in mind, <strong>strategies may change</strong>.
    </p>
  {% endif %}

  {% if discord %}
    <p>This was originally written on Discord so the text may be confusing. 
      It is kept this way to preserve the original posts how they were.<br>
  {% endif %}

  {% if '/ranking-news' in page.url %}
    <a href="https://exponential-idle-guides.netlify.app/guide-extensions/rankings-main/"><strong><u>Main Rankings Page</u></strong></a>
  {% elif not glossary %}
    <p class="draft-warning">Feel free to use the <a href="https://exponential-idle-guides.netlify.app/guide-extensions/glossary/">glossary</a> as needed.
  {% endif %}
  
  {{ content | safe }}
  {% if '/rankings-main' in page.url %}
    <h3>Previous Rankings</h3>
    <ul>
      {% for year, yearPosts in collections.postsByYear %}
        <li>{{ year }}</li>
        <ul>
          {% for post in yearPosts | reverse %}
            {% if '/ranking-news' in post.url %}
              {% set title = post.data.title | string %}
              <li>
                <a href="{{post.url}}">
                  {% if 'Rankings & News' in title %}
                    {{ title.slice(16,-5) }}
                  {% else %}
                    {{ post.data.title }}
                  {% endif %}
                </a>
              </li>
            {% endif %}
          {% endfor %}
        </ul>
      {% endfor %}
    </ul>
  {% endif %}
  
{% endblock %}

{% block sidebar %}
  {% if not home %}
    {% set tocs = content | toc %}
    {% if tocs %}
      <div id="HeaderSidebar" class="sidebar">
        <a href="javascript:void(0)" id="HeaderClose" class="closebtn" onclick="closeSidebar()">ⓧ</a>
        <h1 class="sidebartitle">Table of Contents</h1>
        <div class="content_wrapper square_list">
          {{content|toc|safe}}
        </div>
      </div>
      <div id="HeaderSidebarinvis" class="sidebar">
        <a href="javascript:void(0)" id="HeaderClose" class="closebtn" onclick="closeSidebar()">ⓧ</a>
        <h1 class="sidebartitle">Table of Contents</h1>
        <div class="content_wrapper square_list">
          {{content|toc|safe}}
        </div>
      </div>
    {% else %}
      <div id="HeaderSidebar" class="sidebar">
        <a href="javascript:void(0)" id="HeaderClose" class="closebtn" onclick="closeSidebar()">ⓧ</a>
        <h1 class="sidebartitle">Table of Contents</h1>
        <div class="content_wrapper square_list">
          <p>No headers have been established.<br>Please add headers for Table of Contents.</p>
        </div>
      </div>
      <div id="HeaderSidebarinvis" class="sidebar">
        <a href="javascript:void(0)" id="HeaderClose" class="closebtn" onclick="closeSidebar()">ⓧ</a>
        <h1 class="sidebartitle">Table of Contents</h1>
        <div class="content_wrapper square_list">
          <p>No headers have been established.<br>Please add headers for Table of Contents.</p>
        </div>
      </div>
    {% endif %}

    <div id="GuideSidebar" class="sidebar">
      <a href="javascript:void(0)" id="GuideClose" class="closebtn" onclick="closeSidebar()">ⓧ</a>
      <h1 class="sidebartitle">Guides</h1>
      <div class="content_wrapper square_list">
        <ul>
          {%- for guide in collections.guides -%}
            <li>
              <a href="{{guide.url}}">{{ guide.data.title }}</a>
            </li>
          {%- endfor -%}
        </ul>
      </div>
    </div>
    <div id="GuideSidebarinvis" class="sidebar">
      <a href="javascript:void(0)" id="GuideClose" class="closebtn" onclick="closeSidebar()">ⓧ</a>
      <h1 class="sidebartitle">Guides</h1>
      <div class="content_wrapper square_list">
        <ul>
          {%- for guide in collections.guides -%}
            <li>
              <a href="{{guide.url}}">{{ guide.data.title }}</a>
            </li>
          {%- endfor -%}
        </ul>
      </div>
    </div>

    <div id="ResourceSidebar" class="sidebar">
      <a href="javascript:void(0)" id="ResourceClose" class="closebtn" onclick="closeSidebar()">ⓧ</a>
      <h1 class="sidebartitle">Resources</h1>
      <div class="content_wrapper square_list">
        {% include 'tools.njk' %}
      </div>
    </div>
    <div id="ResourceSidebarinvis" class="sidebar">
      <a href="javascript:void(0)" id="ResourceClose" class="closebtn" onclick="closeSidebar()">ⓧ</a>
      <h1 class="sidebartitle">Resources</h1>
      <div class="content_wrapper square_list">
        {% include 'tools.njk' %}
      </div>
    </div>
    
    <div id="ExtensionsSidebar" class="sidebar">
      <a href="javascript:void(0)" id="ExtensionsClose" class="closebtn" onclick="closeSidebar()">ⓧ</a>
      <h1 class="sidebartitle">Guide Extensions</h1>
      <div class="content_wrapper square_list">
        <ul>
          {%- for post in collections.extensions -%}
            <li>
              <a href="{{post.url}}">{{ post.data.title }}</a>
            </li>
          {%- endfor -%}
        </ul>
      </div>
    </div>
    <div id="ExtensionsSidebarinvis" class="sidebar">
      <a href="javascript:void(0)" id="ExtensionsClose" class="closebtn" onclick="closeSidebar()">ⓧ</a>
      <h1 class="sidebartitle">Guide Extensions</h1>
      <div class="content_wrapper square_list">
        <ul>
          {%- for post in collections.extensions -%}
            <li>
              <a href="{{post.url}}">{{ post.data.title }}</a>
            </li>
          {%- endfor -%}
        </ul>
      </div>
    </div>

    {% if '/ranking-news' in page.url %}
      <div id="RankingsSidebar" class="sidebar">
        <a href="javascript:void(0)" id="RankingsClose" class="closebtn" onclick="closeSidebar()">ⓧ</a>
        <h1 class="sidebartitle">Rankings</h1>
        <div class="content_wrapper square_list">
          <ul>
            {% for year, yearPosts in collections.postsByYear %}
              <li>{{ year }}</li>
              <ul>
                {% for post in yearPosts | reverse %}
                  {% if ('/ranking-news' in post.url) and not ('index' in post.url) %}
                    {% set title = post.data.title | string %}
                    <li>
                      <a href="{{post.url}}">
                        {% if 'Rankings & News' in title %}
                          {{ title.slice(16,-5) }}
                        {% else %}
                          {{ post.data.title }}
                        {% endif %}
                      </a>
                    </li>
                  {% endif %}
                {% endfor %}
              </ul>
            {% endfor %}
          </ul>
        </div>
      </div>
      <div id="RankingsSidebarinvis" class="sidebar">
        <a href="javascript:void(0)" id="RankingsClose" class="closebtn" onclick="closeSidebar()">ⓧ</a>
        <h1 class="sidebartitle">Rankings</h1>
        <div class="content_wrapper square_list">
          <ul>
            {% for year, yearPosts in collections.postsByYear %}
              <li>{{ year }}</li>
              <ul>
                {% for post in yearPosts | reverse %}
                  {% if ('/ranking-news' in post.url) and not ('index' in post.url) %}
                    {% set title = post.data.title | string %}
                    <li>
                      <a href="{{post.url}}">
                        {% if 'Rankings & News' in title %}
                          {{ title.slice(16,-5) }}
                        {% else %}
                          {{ post.data.title }}
                        {% endif %}
                      </a>
                    </li>
                  {% endif %}
                {% endfor %}
              </ul>
            {% endfor %}
          </ul>
        </div>
      </div>
    {% endif %}
      
    <div id="SidebarHeaders" class="sidebar">
      <h1 class="sidebartitle">More Guides ⓧ</h1>
      <h1 class="sidebartitle">Table of Contents ⓧ</h1>
      <h1 class="sidebartitle">Other Resources ⓧ</h1>
      <h1 class="sidebartitle">Guide Extensions ⓧ</h1>
      {% if '/ranking-news' in page.url %}
        <h1 class="sidebartitle">Rankings ⓧ</h1>
      {% endif %}
    </div>
    
    <div id="sidebarMain">
      <div id="sidebarNavigation">
        <button id="button_nav" class="openbtn" onclick="Navigation('sidebarOptions')">☰Navigation</button>
      </div>
      <div id="sidebarOptions">
        <div>
          <button class="openbtn" onclick="openSidebar(['GuideSidebar','HeaderSidebar','ResourceSidebar','ExtensionsSidebar'],'SidebarHeaders')">☰More Guides</button>
        </div>
        <div>
          <button class="openbtn" onclick="openSidebar(['HeaderSidebar','GuideSidebar','ResourceSidebar','ExtensionsSidebar'],'SidebarHeaders')">☰Table of <span style="display:inline-block;">Contents</span></button>
        </div>
        <div>
          <button class="openbtn" onclick="openSidebar(['ResourceSidebar','GuideSidebar','HeaderSidebar','ExtensionsSidebar'],'SidebarHeaders')">☰Other Resources</button>
        </div>
        <div>
          <button class="openbtn" onclick="openSidebar(['ExtensionsSidebar','ResourceSidebar','GuideSidebar','HeaderSidebar'],'SidebarHeaders')">☰Extensions</button>
        </div>
      </div>
      {% if '/ranking-news' in page.url %}
        <div>
          <button class="openbtn" onclick="openSidebar(['RankingsSidebar','ExtensionsSidebar','ResourceSidebar','GuideSidebar','HeaderSidebar'],'SidebarHeaders')">☰Rankings</button>
        </div>
      {% endif %}
    </div>
  {% endif %}
{% endblock %}